[
  {
    "question": "<b>Scenario:</b><br>A company wants to analyze employee salary and department data for reporting purposes.<br>The HR department needs summary information such as total employees, average salary, highest salary, and department-wise analysis using SQL aggregate functions.<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary<br><br><b>Task Requirements:</b><br>1. Create a table named <b>EMPLOYEES</b> with appropriate columns and data types.<br>2. Insert at least five employee records with different salaries and departments.<br>3. Find the total number of employees in the company.<br>4. Find the total salary paid to all employees.<br>5. Find the average salary of employees.<br>6. Find the highest salary in the company.<br>7. Find the lowest salary in the company.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000);\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000);\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000);\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000);\nINSERT INTO EMPLOYEES VALUES (5, 'David', 'HR', 55000);\nSELECT COUNT(*) FROM EMPLOYEES;\nSELECT SUM(salary) FROM EMPLOYEES;\nSELECT AVG(salary) FROM EMPLOYEES;\nSELECT MAX(salary) FROM EMPLOYEES;\nSELECT MIN(salary) FROM EMPLOYEES;",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td></tr><tr><td>5</td><td>David</td><td>HR</td><td>55000</td></tr></table>",
    "sampleOutput": "<p><b>1. Total Employees</b></p><table border='1' style='border-collapse: collapse;'><tr><th>COUNT(*)</th></tr><tr><td>5</td></tr></table><br><p><b>2. Total Salary</b></p><table border='1' style='border-collapse: collapse;'><tr><th>SUM(salary)</th></tr><tr><td>300000</td></tr></table><br><p><b>3. Average Salary</b></p><table border='1' style='border-collapse: collapse;'><tr><th>AVG(salary)</th></tr><tr><td>60000</td></tr></table><br><p><b>4. Highest Salary</b></p><table border='1' style='border-collapse: collapse;'><tr><th>MAX(salary)</th></tr><tr><td>70000</td></tr></table><br><p><b>5. Lowest Salary</b></p><table border='1' style='border-collapse: collapse;'><tr><th>MIN(salary)</th></tr><tr><td>50000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and use basic aggregate functions (COUNT, SUM, AVG, MAX, MIN) to analyze salary data.\n",
    "maxMarks": 10,
    "description": "Basic Aggregate Functions"
  },
  {
    "question": "<b>Scenario:</b><br>A company wants to analyze employee data department-wise.<br>The HR team needs grouped summary reports using aggregate functions with GROUP BY.<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary, gender<br><br><b>Task Requirements:</b><br>1. Create a table named <b>EMPLOYEES</b> with appropriate columns and data types.<br>2. Insert employee records belonging to different departments.<br>3. Display the number of employees in each department.<br>4. Display the total salary paid in each department.<br>5. Display the average salary of employees in each department.<br>6. Display the highest salary in each department.<br>7. Display the lowest salary in each department.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2), gender VARCHAR(10));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000, 'Male');\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000, 'Female');\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000, 'Male');\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000, 'Female');\nINSERT INTO EMPLOYEES VALUES (5, 'David', 'HR', 55000, 'Male');\nINSERT INTO EMPLOYEES VALUES (6, 'Priya', 'IT', 45000, 'Female');\nSELECT department, COUNT(*) FROM EMPLOYEES GROUP BY department;\nSELECT department, SUM(salary) FROM EMPLOYEES GROUP BY department;\nSELECT department, AVG(salary) FROM EMPLOYEES GROUP BY department;\nSELECT department, MAX(salary) FROM EMPLOYEES GROUP BY department;\nSELECT department, MIN(salary) FROM EMPLOYEES GROUP BY department;",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary, gender<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th><th>gender</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td><td>Male</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td><td>Female</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td><td>Male</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td><td>Female</td></tr><tr><td>5</td><td>David</td><td>HR</td><td>55000</td><td>Male</td></tr><tr><td>6</td><td>Priya</td><td>IT</td><td>45000</td><td>Female</td></tr></table>",
    "sampleOutput": "<p><b>1. Count per Dept</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>COUNT(*)</th></tr><tr><td>IT</td><td>3</td></tr><tr><td>HR</td><td>2</td></tr><tr><td>Finance</td><td>1</td></tr></table><br><p><b>2. Total Salary per Dept</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>SUM(salary)</th></tr><tr><td>IT</td><td>175000</td></tr><tr><td>HR</td><td>105000</td></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>3. Average Salary per Dept</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>AVG(salary)</th></tr><tr><td>IT</td><td>58333.33</td></tr><tr><td>HR</td><td>52500</td></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>4. Highest Salary per Dept</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MAX(salary)</th></tr><tr><td>IT</td><td>70000</td></tr><tr><td>HR</td><td>55000</td></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>5. Lowest Salary per Dept</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MIN(salary)</th></tr><tr><td>IT</td><td>45000</td></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and use GROUP BY to calculate aggregate values for each department.\n",
    "maxMarks": 10,
    "description": "Aggregate Functions Using GROUP BY"
  },
  {
    "question": "<b>Scenario:</b><br>A company wants to generate filtered summary reports.<br>The HR team needs to apply conditions using the WHERE clause before aggregation.<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary, gender<br><br><b>Task Requirements:</b><br>1. Create a table named <b>EMPLOYEES</b> with appropriate columns and data types.<br>2. Insert records.<br>3. Find the total number of employees whose salary is greater than 40,000.<br>4. Find the average salary of employees who belong to the IT department.<br>5. Find the total salary paid to employees working in the HR department.<br>6. Find the highest salary among female employees.<br>7. Find the lowest salary among male employees.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2), gender VARCHAR(10));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000, 'Male');\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000, 'Female');\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000, 'Male');\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000, 'Female');\nINSERT INTO EMPLOYEES VALUES (5, 'David', 'HR', 55000, 'Male');\nSELECT COUNT(*) FROM EMPLOYEES WHERE salary > 40000;\nSELECT AVG(salary) FROM EMPLOYEES WHERE department = 'IT';\nSELECT SUM(salary) FROM EMPLOYEES WHERE department = 'HR';\nSELECT MAX(salary) FROM EMPLOYEES WHERE gender = 'Female';\nSELECT MIN(salary) FROM EMPLOYEES WHERE gender = 'Male';",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary, gender<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th><th>gender</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td><td>Male</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td><td>Female</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td><td>Male</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td><td>Female</td></tr><tr><td>5</td><td>David</td><td>HR</td><td>55000</td><td>Male</td></tr></table>",
    "sampleOutput": "<p><b>1. Salary > 40k count</b></p><table border='1' style='border-collapse: collapse;'><tr><th>COUNT(*)</th></tr><tr><td>5</td></tr></table><br><p><b>2. Avg Salary IT</b></p><table border='1' style='border-collapse: collapse;'><tr><th>AVG(salary)</th></tr><tr><td>65000</td></tr></table><br><p><b>3. Total Salary HR</b></p><table border='1' style='border-collapse: collapse;'><tr><th>SUM(salary)</th></tr><tr><td>105000</td></tr></table><br><p><b>4. Max Salary Female</b></p><table border='1' style='border-collapse: collapse;'><tr><th>MAX(salary)</th></tr><tr><td>65000</td></tr></table><br><p><b>5. Min Salary Male</b></p><table border='1' style='border-collapse: collapse;'><tr><th>MIN(salary)</th></tr><tr><td>55000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and use the WHERE clause with aggregate functions to filter records before processing.\n",
    "maxMarks": 10,
    "description": "Aggregate Functions Using WHERE Clause"
  },
  {
    "question": "<b>Scenario:</b><br>HR needs to filter records (WHERE) and then group them (GROUP BY).<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary, gender<br><br><b>Task Requirements:</b><br>1. Create table EMPLOYEES.<br>2. Insert records.<br>3. Display number of employees in each department where salary > 40,000.<br>4. Display total salary in each department where employees belong to IT only.<br>5. Display average salary in each department where gender is female.<br>6. Display max salary in each department where salary < 70,000.<br>7. Display min salary in each department where employees are HR or FINANCE.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2), gender VARCHAR(10));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000, 'Male');\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000, 'Female');\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000, 'Male');\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000, 'Female');\nINSERT INTO EMPLOYEES VALUES (6, 'Priya', 'IT', 45000, 'Female');\nSELECT department, COUNT(*) FROM EMPLOYEES WHERE salary > 40000 GROUP BY department;\nSELECT department, SUM(salary) FROM EMPLOYEES WHERE department = 'IT' GROUP BY department;\nSELECT department, AVG(salary) FROM EMPLOYEES WHERE gender = 'Female' GROUP BY department;\nSELECT department, MAX(salary) FROM EMPLOYEES WHERE salary < 70000 GROUP BY department;\nSELECT department, MIN(salary) FROM EMPLOYEES WHERE department IN ('HR', 'Finance') GROUP BY department;",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary, gender<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th><th>gender</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td><td>Male</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td><td>Female</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td><td>Male</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td><td>Female</td></tr><tr><td>6</td><td>Priya</td><td>IT</td><td>45000</td><td>Female</td></tr></table>",
    "sampleOutput": "<p><b>1. Count per Dept (> 40k)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>COUNT(*)</th></tr><tr><td>IT</td><td>3</td></tr><tr><td>HR</td><td>1</td></tr><tr><td>Finance</td><td>1</td></tr></table><br><p><b>2. Total Salary IT</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>SUM(salary)</th></tr><tr><td>IT</td><td>175000</td></tr></table><br><p><b>3. Avg Salary Female</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>AVG(salary)</th></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr><tr><td>IT</td><td>45000</td></tr></table><br><p><b>4. Max Salary (< 70k)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MAX(salary)</th></tr><tr><td>IT</td><td>60000</td></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>5. Min Salary (HR/Finance)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MIN(salary)</th></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and combine WHERE and GROUP BY to perform complex aggregations on filtered data sets.\n",
    "maxMarks": 10,
    "description": "Aggregate Functions Using WHERE and GROUP BY"
  },
  {
    "question": "<b>Scenario:</b><br>HR needs to filter (WHERE), group (GROUP BY), and filter groups (HAVING).<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary, gender<br><br><b>Task Requirements:</b><br>1. Create table EMPLOYEES.<br>2. Insert records.<br>3. Num employees per dept (salary > 40k), show only depts > 2 employees.<br>4. Avg salary per dept (female), show only depts with avg > 50k.<br>5. Total salary per dept (IT or HR), show only depts > 1,00,000.<br>6. Max salary per dept (salary < 80k), show only depts with max > 60k.<br>7. Min salary per dept, show only depts with min > 30k.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2), gender VARCHAR(10));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000, 'Male');\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000, 'Female');\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000, 'Male');\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000, 'Female');\nINSERT INTO EMPLOYEES VALUES (5, 'David', 'HR', 55000, 'Male');\nINSERT INTO EMPLOYEES VALUES (6, 'Priya', 'IT', 45000, 'Female');\nSELECT department, COUNT(*) FROM EMPLOYEES WHERE salary > 40000 GROUP BY department HAVING COUNT(*) > 2;\nSELECT department, AVG(salary) FROM EMPLOYEES WHERE gender = 'Female' GROUP BY department HAVING AVG(salary) > 50000;\nSELECT department, SUM(salary) FROM EMPLOYEES WHERE department IN ('IT', 'HR') GROUP BY department HAVING SUM(salary) > 100000;\nSELECT department, MAX(salary) FROM EMPLOYEES WHERE salary < 80000 GROUP BY department HAVING MAX(salary) > 60000;\nSELECT department, MIN(salary) FROM EMPLOYEES GROUP BY department HAVING MIN(salary) > 30000;",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary, gender<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th><th>gender</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td><td>Male</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td><td>Female</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td><td>Male</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td><td>Female</td></tr><tr><td>5</td><td>David</td><td>HR</td><td>55000</td><td>Male</td></tr><tr><td>6</td><td>Priya</td><td>IT</td><td>45000</td><td>Female</td></tr></table>",
    "sampleOutput": "<p><b>1. Depts > 2 Employees (> 40k)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>COUNT(*)</th></tr><tr><td>IT</td><td>3</td></tr></table><br><p><b>2. Avg Female > 50k</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>AVG(salary)</th></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>3. Total IT/HR > 100k</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>SUM(salary)</th></tr><tr><td>IT</td><td>175000</td></tr><tr><td>HR</td><td>105000</td></tr></table><br><p><b>4. Max (< 80k) > 60k</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MAX(salary)</th></tr><tr><td>IT</td><td>70000</td></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>5. Min > 30k</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MIN(salary)</th></tr><tr><td>IT</td><td>45000</td></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and use the HAVING clause to filter groups generated by the GROUP BY operation.\n",
    "maxMarks": 10,
    "description": "Aggregate Functions Using WHERE, GROUP BY, and HAVING"
  },
  {
    "question": "<b>Scenario:</b><br>HR needs to sort gathered data (ORDER BY).<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary, gender<br><br><b>Task Requirements:</b><br>1. Create table EMPLOYEES.<br>2. Insert records.<br>3. Total salary per dept, sorted ASC.<br>4. Avg salary per dept, sorted DESC.<br>5. Num employees per dept, sorted by count DESC.<br>6. Max salary per dept, sorted DESC.<br>7. Min salary per dept, sorted ASC.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2), gender VARCHAR(10));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000, 'Male');\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000, 'Female');\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000, 'Male');\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000, 'Female');\nSELECT department, SUM(salary) FROM EMPLOYEES GROUP BY department ORDER BY SUM(salary) ASC;\nSELECT department, AVG(salary) FROM EMPLOYEES GROUP BY department ORDER BY AVG(salary) DESC;\nSELECT department, COUNT(*) FROM EMPLOYEES GROUP BY department ORDER BY COUNT(*) DESC;\nSELECT department, MAX(salary) FROM EMPLOYEES GROUP BY department ORDER BY MAX(salary) DESC;\nSELECT department, MIN(salary) FROM EMPLOYEES GROUP BY department ORDER BY MIN(salary) ASC;",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary, gender<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th><th>gender</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td><td>Male</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td><td>Female</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td><td>Male</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td><td>Female</td></tr></table>",
    "sampleOutput": "<p><b>1. Total Salary (Sorted ASC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>SUM(salary)</th></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr><tr><td>IT</td><td>130000</td></tr></table><br><p><b>2. Avg Salary (Sorted DESC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>AVG(salary)</th></tr><tr><td>IT</td><td>65000</td></tr><tr><td>Finance</td><td>65000</td></tr><tr><td>HR</td><td>50000</td></tr></table><br><p><b>3. Employee Count (Sorted DESC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>COUNT(*)</th></tr><tr><td>IT</td><td>2</td></tr><tr><td>HR</td><td>1</td></tr><tr><td>Finance</td><td>1</td></tr></table><br><p><b>4. Max Salary (Sorted DESC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MAX(salary)</th></tr><tr><td>IT</td><td>70000</td></tr><tr><td>Finance</td><td>65000</td></tr><tr><td>HR</td><td>50000</td></tr></table><br><p><b>5. Min Salary (Sorted ASC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MIN(salary)</th></tr><tr><td>HR</td><td>50000</td></tr><tr><td>IT</td><td>60000</td></tr><tr><td>Finance</td><td>65000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and use ORDER BY to sort the resulting aggregate values (like SUM or COUNT).\n",
    "maxMarks": 10,
    "description": "Aggregate Functions Using ORDER BY"
  },
  {
    "question": "<b>Scenario:</b><br>Advanced Analytics: Filter, Group, Filter Groups, and Sort.<br><br><b>Table Details:</b><br>Table Name: EMPLOYEES<br>Column Name: emp_id, emp_name, department, salary, gender<br><br><b>Task Requirements:</b><br>1. Create table EMPLOYEES.<br>2. Insert records.<br>3. Total salary (salary > 40k), only depts > 100k total, sorted DESC.<br>4. Avg salary (female), only depts > 50k avg, sorted ASC.<br>5. Count employees (IT/HR), only depts > 2 employees, sorted DESC.<br>6. Max salary (< 80k), only depts > 60k max, sorted DESC.<br>7. Min salary, only depts > 30k min, sorted ASC.",
    "answer": "CREATE TABLE EMPLOYEES (emp_id INT PRIMARY KEY, emp_name VARCHAR(50), department VARCHAR(50), salary DECIMAL(10,2), gender VARCHAR(10));\nINSERT INTO EMPLOYEES VALUES (1, 'John', 'IT', 60000, 'Male');\nINSERT INTO EMPLOYEES VALUES (2, 'Sara', 'HR', 50000, 'Female');\nINSERT INTO EMPLOYEES VALUES (3, 'Mike', 'IT', 70000, 'Male');\nINSERT INTO EMPLOYEES VALUES (4, 'Emma', 'Finance', 65000, 'Female');\nINSERT INTO EMPLOYEES VALUES (5, 'David', 'HR', 55000, 'Male');\nINSERT INTO EMPLOYEES VALUES (6, 'Priya', 'IT', 45000, 'Female');\nSELECT department, SUM(salary) FROM EMPLOYEES WHERE salary > 40000 GROUP BY department HAVING SUM(salary) > 100000 ORDER BY SUM(salary) DESC;\nSELECT department, AVG(salary) FROM EMPLOYEES WHERE gender = 'Female' GROUP BY department HAVING AVG(salary) > 50000 ORDER BY AVG(salary) ASC;\nSELECT department, COUNT(*) FROM EMPLOYEES WHERE department IN ('IT', 'HR') GROUP BY department HAVING COUNT(*) > 2 ORDER BY COUNT(*) DESC;\nSELECT department, MAX(salary) FROM EMPLOYEES WHERE salary < 80000 GROUP BY department HAVING MAX(salary) > 60000 ORDER BY MAX(salary) DESC;\nSELECT department, MIN(salary) FROM EMPLOYEES GROUP BY department HAVING MIN(salary) > 30000 ORDER BY MIN(salary) ASC;",
    "sampleInput": "Table: <b>EMPLOYEES</b><br>Columns: emp_id, emp_name, department, salary, gender<br><table border='1' style='border-collapse: collapse; width: 100%;'><tr><th>emp_id</th><th>emp_name</th><th>department</th><th>salary</th><th>gender</th></tr><tr><td>1</td><td>John</td><td>IT</td><td>60000</td><td>Male</td></tr><tr><td>2</td><td>Sara</td><td>HR</td><td>50000</td><td>Female</td></tr><tr><td>3</td><td>Mike</td><td>IT</td><td>70000</td><td>Male</td></tr><tr><td>4</td><td>Emma</td><td>Finance</td><td>65000</td><td>Female</td></tr><tr><td>5</td><td>David</td><td>HR</td><td>55000</td><td>Male</td></tr><tr><td>6</td><td>Priya</td><td>IT</td><td>45000</td><td>Female</td></tr></table>",
    "sampleOutput": "<p><b>1. Total (> 40k) > 100k (DESC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>SUM(salary)</th></tr><tr><td>IT</td><td>175000</td></tr><tr><td>HR</td><td>105000</td></tr></table><br><p><b>2. Avg Female > 50k (ASC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>AVG(salary)</th></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>3. Count (IT/HR) > 2 (DESC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>COUNT(*)</th></tr><tr><td>IT</td><td>3</td></tr></table><br><p><b>4. Max (< 80k) > 60k (DESC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MAX(salary)</th></tr><tr><td>IT</td><td>70000</td></tr><tr><td>Finance</td><td>65000</td></tr></table><br><p><b>5. Min > 30k (ASC)</b></p><table border='1' style='border-collapse: collapse;'><tr><th>department</th><th>MIN(salary)</th></tr><tr><td>IT</td><td>45000</td></tr><tr><td>HR</td><td>50000</td></tr><tr><td>Finance</td><td>65000</td></tr></table>",
    "initialCode": "-- Hint: Create the EMPLOYEES table, insert records, and combine WHERE, GROUP BY, HAVING, and ORDER BY for comprehensive data analysis.\n",
    "maxMarks": 10,
    "description": "Aggregate Functions Using WHERE, GROUP BY, HAVING & ORDER BY"
  }
]